@*CompanyInvites *@
@inherits AuthenticatedComponentBase

<AnimatedCard Index="Index"
			  Class="p-3 mb-3">
	<MudCardHeader>
		<CardHeaderContent>
			<MudText Typo="Typo.h2" Color="Color.Primary">Invitations</MudText>
			<MudDivider Class="mb-3" />
		</CardHeaderContent>
	</MudCardHeader>
	<MudCardContent>
		@if (!Invites.Any())
		{
			<NotFoundDisplay Message="No invitations found for this company." />
		}
		else
		{
			<MudTabs Elevation="0" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6">
				<MudTabPanel Text="Pending Invites">
					<CompanyInviteTable Invites="@PendingInvites" />
				</MudTabPanel>
				<MudTabPanel Text="Accepted Invites">
					<CompanyInviteTable Invites="@AcceptedInvites" />
				</MudTabPanel>
				<MudTabPanel Text="Cancelled/Expired Invites">
					<CompanyInviteTable Invites="@CancelledInvites" />

				</MudTabPanel>
			</MudTabs>
		}
		@if (IsAdmin)
		{
			<SafeNavButton Valid="true"
						   Color="Color.Tertiary"
						   Variant="Variant.Text"
						   Size="Size.Small"
						   Class="project-details-link me-auto mt-2"
						   StartIcon="@Icons.Material.Filled.PersonAdd"
						   TypeText="Invite New Member"
						   Href="/company/invite" />
		}
	</MudCardContent>
</AnimatedCard>
@code {
	#region PARAMETERS
	[Parameter, EditorRequired]
	public int Index { get; set; }

	[Parameter]
	public CompanyDTO? Company { get; set; }

	
	[Parameter,EditorRequired]
	public IEnumerable<InviteDTO> Invites { get; set; } = [];
	#endregion

	#region STATE

	#endregion
	#region COMPUTED PROPERTIES
	private IEnumerable<InviteDTO> PendingInvites => Invites.Where(i => i.IsValid == true);
	private IEnumerable<InviteDTO> AcceptedInvites => Invites.Where(i => i.JoinDate.HasValue || !string.IsNullOrEmpty(i.InviteeId));
	private IEnumerable<InviteDTO> CancelledInvites => Invites.Where(i => i.IsValid == false && !i.JoinDate.HasValue);
	#endregion
}
